{% extends 'base.html' %}

{% block content %}

        {% comment %} --- Article information --- {% endcomment%}
	     <div class='title_line'>
			 {% if article in user_articles or not user.is_authenticated %}
				  <a class='title_without_upvote' href="{{ article.url }}">{{ article.title }}</a></div>
		    {% else %}
			     <a href="{% url 'ed_news:upvote_article' article.id %}">&#9650</a>
				  <a href="{{ article.url }}">{{ article.title }}</a></div>
		    {% endif %}
		  <div class='points_line points_line_discuss'>
			 {{ article.upvotes }}{% if article.upvotes != 1 %} points{% else %} point{% endif %}
			 by <a href="{% url 'profile' article.author.id %}">{{ article.author }}</a>
			 {{ age }} ago |
			 <a href="{% url 'ed_news:discuss' article.id %}">
				{% if comment_count == 0 %}discuss{% elif comment_count == 1 %}1 comment{% else %}{{ comment_count }} comments{% endif %}
		    </a>
		  </div>


		  {% comment %} --- Comment entry form --- {% endcomment%}
		  <form id='comment_form' method="post" action="{% url 'ed_news:discuss' article.id %}" enctype='multipart/form-data'>
			 {% csrf_token %}

			 <div class='comment_entry_form'>

				{{ comment_entry_form.as_p }}

				<div class='comment_submit_button'>
				  {% if user.is_authenticated %}
				    <input id='submit_comment_button' type="submit" name='submit' value="Add comment" />
				  {% else %}
				    <input id='submit_comment_button' type="submit" name='submit' value="Add comment" disabled />
				    You will have to <a href="{% url 'login' %}">log in</a> or <a href="{% url 'register' %}">register</a> to make a comment.</p>
				  {% endif %}
            </div>

			 </div>
				  
		  </form>

		  

	 {% comment %} --- All comments --- {% endcomment%}
    {% for comment_dict in comment_set %}

		  <div class='comment'>
			   <div>
				  {% if comment_dict.comment in user_comments or not user.is_authenticated %}
			       <a class='title_without_upvote' href="{% url 'profile' comment_dict.comment.author.id %}">{{ comment_dict.comment.author }}</a>
				  {% else %}
					 <a href="">&#9650</a>
					 <a href="{% url 'profile' comment_dict.comment.author.id %}">{{ comment_dict.comment.author }}</a>
				  {% endif %}
				  {{ comment_dict.age }} ago
			   </div>
				<div class='comment_text'>{{ comment_dict.comment.comment_text }}</div>
				<div class='reply_link'>reply</div>
		  </div>

	 {% endfor %}


{% endblock %}
